<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Covariance Estimation With Switchable Constraints  --- Continued </title>
    <meta name="description" content="">

    <link rel="stylesheet" href="https://watsonryan.github.io/researchNotes/css/main.css">
    <link rel="canonical" href="https://watsonryan.github.io/researchNotes/_projects/summerafit/2017/05/25/Update.html">

<!-- meta robots -->
    

<!-- loading fonts -->
    <!-- Open Sans -->
    <link href="https://watsonryan.github.io/researchNotes/_assets/open_sans/style.css" rel="stylesheet">

    <!-- own icon font, created via https://icomoon.io/  -->
    <link href="https://watsonryan.github.io/researchNotes/_assets/lablogIcons/style.css" rel="stylesheet">

    <!-- Ubuntu Mono for code -->
    <link href="https://watsonryan.github.io/researchNotes/_assets/Ubuntu_Mono/style.css" rel='stylesheet' type='text/css'>

<!-- mathjax.org for math equations -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    imageFont: null,
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} ,
    menuSettings: { context: "Browser" }
    });
    </script>

    <script type="text/javascript"  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

<!-- highlight.js for code syntax highlighting-->
<link rel="stylesheet" href="https://watsonryan.github.io/researchNotes/_assets/highlight/styles/github.css">
<script src="https://watsonryan.github.io/researchNotes/_assets/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!--<link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/default.min.css">
<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>-->


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/researchNotes/index.html">Research Notes</a>

  <nav  class="main-menu">
  <input type="checkbox" id="menu" />
  <label for="menu"></label>
  <div class="trigger">

    <a class="page-link" href="/researchNotes/index.html"><span style = "font-family: 'lablogIcons';">  &#xe605; </span> Research Notes</a>

    
      <a class="page-link" href="/researchNotes/tasks.html"><span style = "font-family: 'lablogIcons';">  &#xf046; </span> Tasks</a>
    

    
<a class="page-link" href="/researchNotes/tags.html"><span style = "font-family: 'lablogIcons';">  &#xe600; </span> Tags</a>
    

    
      <a class="page-link" href="/researchNotes/archive.html"><span style = "font-family: 'lablogIcons';">  &#xe602; </span> Archive</a>
    

    <br>

    
      <a class="page-link" href="/researchNotes/_projects/labUpdates/labUpdates.html">
        <span style = "font-family: 'lablogIcons';">  &#xe60a; </span>
        
        
        Lab Updates
      </a>
    
      <a class="page-link" href="/researchNotes/_projects/pollinatorBot/pollinatorBot.html">
        <span style = "font-family: 'lablogIcons';">  &#xe60a; </span>
        
        
        Pollinator Bot Updates
      </a>
    
      <a class="page-link" href="/researchNotes/_projects/summerAFIT/summerAFIT.html">
        <span style = "font-family: 'lablogIcons';">  &#xe60a; </span>
        
        
        AFIT Updates
      </a>
    
      <a class="page-link" href="/researchNotes/_projects/tutorials/tutorials.html">
        <span style = "font-family: 'lablogIcons';">  &#xe60a; </span>
        
        
        Tutorials
      </a>
    

    

    <br>

    
    <div class="menu-content">
      

    </div>
    

    

  </div>

  </nav>


  </div>


</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Covariance Estimation With Switchable Constraints  --- Continued </h1>
    <p class="post-meta">May 25, 2017 • Ryan Watson</p>

    
    <div>
     
       <a href="/researchNotes/tags.html#summerAFIT" title="Pages tagged summerAFIT" rel="tag" class = "tag"> summerAFIT </a>  &nbsp
     
       <a href="/researchNotes/tags.html#covariance" title="Pages tagged covariance" rel="tag" class = "tag"> covariance </a>  &nbsp
     
       <a href="/researchNotes/tags.html#switchable+constraints" title="Pages tagged switchable constraints" rel="tag" class = "tag"> switchable constraints </a>  &nbsp
     
    </div>
    

  </header>

  <article class="post-content">
    <h2 id="testing-sc-on-larger-graphs">Testing S.C. on Larger Graphs</h2>

<p>To test S.C. on a larger graph, the Manhattan 3500 simulated dataset will be utilized. Using this pose graph, several false loop closure constraints will be added to see well S.C. can handle faults when confronted with a much larger search space.</p>

<p><img src="http://www.lucacarlone.com/images/M3500_eg2o.jpg" alt="Man3500" /></p>
<p align="center">
Fig 1 :: True Manhattan wold 3500 ground truth 
</p>
<p><br /></p>

<p>In Figure 2, the Manhattan 3500 pose graph with 80 locrmw@rmw:~/Documents/git/wvupng/core/source/gtsam/build$ ./examples/maxMixExample -g collect1.gtsam –measWeight 10 –mixWeight 0.2 –writeENU<br />
ally clustered false loop closure constraints can be seen. Utilizing this graph we will begin test switchable constraints.</p>

<p align="center">
<a href="https://lh3.googleusercontent.com/YzLWXVakmLl08noriCmIFPzwmkRnIbkVS9Fu_9oBG4-eBdg9MCgphiuMcoNcLLMHWzNgiADmwp8pWleIxq2AV0L3KVbQqJ9sTtskps45WEa9DxcZi7-7KkVzXA7ClkfULVcOaukHEQ=w630-h456-no" target="_blank"><img src="https://lh3.googleusercontent.com/YzLWXVakmLl08noriCmIFPzwmkRnIbkVS9Fu_9oBG4-eBdg9MCgphiuMcoNcLLMHWzNgiADmwp8pWleIxq2AV0L3KVbQqJ9sTtskps45WEa9DxcZi7-7KkVzXA7ClkfULVcOaukHEQ=w630-h456-no" border="0" alt="man35_100 photo man35Faulty_zps1npeiktb.png" /></a>
</p>
<p align="center">
Fig 2 :: Faulty Manhattan wold 3500 pose graph 
</p>
<p><br /></p>

<p>The first thing we can look at is the total graph error ( $\chi^2$ ) for both optimization routines. The $\chi^2$ values for $L_2$ and switch factors can be seen in Table 1.</p>

<table class="mbtablestyle">
  <thead>
    <tr>
      <th style="text-align: center">Optimization Routine</th>
      <th style="text-align: center">$\mathcal{X}^2$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">$L_2$</td>
      <td style="text-align: center">17980.3</td>
    </tr>
    <tr>
      <td style="text-align: center">Switch Factor</td>
      <td style="text-align: center">221.5</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>Next, we can visualize the distribution of the magnitude of the optimized weighting parameter, which is provided in Figure 3 as a histogram. From this figure, it can be seen that there is a very clear delineation between what the optimizers believes to be clean observables and those it believes to be faulty. Additionally, it should be noted that the optimizer substantially de-weighted 80 observables, which is the number of faulty constraints that were added to the graph ( currently faults are added randomly to the graph and I do not keep track of their location, so, unfortunately, I can not provided the precision or recall of the weighting scheme today. I’ll re-write the code tomorrow to look into it. ).</p>

<p align="center">
<a href="https://lh3.googleusercontent.com/GKLn0uKgQtYG9aCqCNW5H37XWl-M-ZqJ8oNJk32aT1sySt4YCn42E8_-vNHwjucatuao50SIyUsMiI6f_uU57FEaad_NWGnz4o8JxGWzOdPQSx-dkshoyF_jT_hvCBYaM0JvnXrkNg=w630-h331-no" target="_blank"><img src="https://lh3.googleusercontent.com/GKLn0uKgQtYG9aCqCNW5H37XWl-M-ZqJ8oNJk32aT1sySt4YCn42E8_-vNHwjucatuao50SIyUsMiI6f_uU57FEaad_NWGnz4o8JxGWzOdPQSx-dkshoyF_jT_hvCBYaM0JvnXrkNg=w630-h331-no" border="0" alt="switchFreq photo swFreq_zpsxnmzlb2s.png" /></a>
</p>
<p align="center">
Fig 3 :: Switch Constraint Weighting Histogram 
</p>
<p><br /><br /></p>

<h2 id="testing-accuracy-of-covariance-estimate">Testing Accuracy of Covariance Estimate</h2>

<p>Now that we have switchable constraints working in GTSAM, we need to evaluate the accuracy of its covariance estimate. To do this we will use the measure, which was introduced in <a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=1543265&amp;tag=1">this paper</a>, shown below,</p>

<script type="math/tex; mode=display">% <![CDATA[
d(P_1,P_2) = 1 - \frac{Tr \lbrace P_1P_2 \rbrace }{||P_1||_f ||P_2||_f} = 1 - \frac{<vec \lbrace P_1 \rbrace , vec \lbrace P_2 \rbrace > }{ ||vec \lbrace P_1 \rbrace ||_2 || vec \lbrace P_2 \rbrace ||_2 }  \in [ 0,1 ] , %]]></script>

<p>where $P_1$ is the true covariance, which is calculated as $P_1 = E[(x-\hat{x})(x-\hat{x})^T]$, and $P_2$ is the covariance provided by the estimator.</p>

<h3 id="testing-on-simple-graph">Testing On Simple Graph</h3>

<p>Using the simple graph that contains one false loop closure between the second and fourth nodes, as depicted in Figure 4, we will evaluate the accuracy of the covariance estimate for $L_2$ and switch constraints.</p>

<p align="center">
<a href="https://lh3.googleusercontent.com/7eTw5aQx5E1VhMx4kHF1YsAcEBJLzqw8tWebU_gcNCF1sMKCWl0xBovRL4zY4XNS6rU8rJdNBjjB0auMyWUDJZDg01JsoFzbPwqUr7-Ss3T0YLvaZhAN0WxWKsCqSMBws1qyugNrUA=w630-h331-no" target="_blank"><img src="https://lh3.googleusercontent.com/7eTw5aQx5E1VhMx4kHF1YsAcEBJLzqw8tWebU_gcNCF1sMKCWl0xBovRL4zY4XNS6rU8rJdNBjjB0auMyWUDJZDg01JsoFzbPwqUr7-Ss3T0YLvaZhAN0WxWKsCqSMBws1qyugNrUA=w630-h331-no" border="0" alt="incorrectOdo photo odometryTestCorrect_zpsgtdn0vsr.png" /></a>
</p>
<p align="center">
Fig 4 :: Simple Graph With One False Loop Closure Constraint  
</p>
<p><br /></p>

<p>In Figure 5, the discrepancy between the true covariance and the estimated covariance for both estimators, with respect to the metric described above, can be seen. From this figure, it seems as though, in general, $L_2$ is providing a better estimate of the covariance; however, this is only one test case.</p>

<p align="center">
<a href="https://lh3.googleusercontent.com/g5sd97py4SY_BuQTw7pLj83Z3lbCCDMos_NIPskNNGk7EYQ_NqmJBZRVDzBs8Mt8-b-ouH7GFPUH5NQHZAc-kTAw5mpPSyoHg5-Ot4gIeAp_GSqjWHR6lSeG5WpMg_t8ekiqgXk2Iw=w630-h331-no" target="_blank"><img src="https://lh3.googleusercontent.com/g5sd97py4SY_BuQTw7pLj83Z3lbCCDMos_NIPskNNGk7EYQ_NqmJBZRVDzBs8Mt8-b-ouH7GFPUH5NQHZAc-kTAw5mpPSyoHg5-Ot4gIeAp_GSqjWHR6lSeG5WpMg_t8ekiqgXk2Iw=w630-h331-no" border="0" alt="incorrectOdo photo odometryTestCorrect_zpsgtdn0vsr.png" /></a>
</p>
<p align="center">
Fig 5 :: Covariance recovery accuracy   
</p>
<p><br /></p>

<h4 id="will-be-continued-tomorrow">Will be continued tomorrow…</h4>


  </article>

</div>

<div class="related-posts">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3>Related Posts:</h3>
  <ul>
  
  <li class="relatedPost">
  <a href="/researchNotes/_projects/summerafit/2017/07/26/Update.html">Variational Inference: A Brief Introduction
  </a> <span class = "post-meta"> • July 26, 2017</span>
  
  <span class = "post-meta"> • </span>
  
    <a href="/researchNotes/tags.html#summerAFIT" title="Pages tagged summerAFIT" rel="tag" class = "tag"> summerAFIT </a>  &nbsp
  
    <a href="/researchNotes/tags.html#covariance" title="Pages tagged covariance" rel="tag" class = "tag"> covariance </a>  &nbsp
  
    <a href="/researchNotes/tags.html#switchable+constraints" title="Pages tagged switchable constraints" rel="tag" class = "tag"> switchable constraints </a>  &nbsp
  
  

  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="relatedPost">
  <a href="/researchNotes/_projects/summerafit/2017/07/25/Update.html">Continued Testing of EM on Faulty Pose Graphs
  </a> <span class = "post-meta"> • July 25, 2017</span>
  
  <span class = "post-meta"> • </span>
  
    <a href="/researchNotes/tags.html#summerAFIT" title="Pages tagged summerAFIT" rel="tag" class = "tag"> summerAFIT </a>  &nbsp
  
    <a href="/researchNotes/tags.html#covariance" title="Pages tagged covariance" rel="tag" class = "tag"> covariance </a>  &nbsp
  
    <a href="/researchNotes/tags.html#switchable+constraints" title="Pages tagged switchable constraints" rel="tag" class = "tag"> switchable constraints </a>  &nbsp
  
  

  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="relatedPost">
  <a href="/researchNotes/_projects/summerafit/2017/07/24/Update.html">Initial Processing Test of EM on Faulty Pose Graphs
  </a> <span class = "post-meta"> • July 24, 2017</span>
  
  <span class = "post-meta"> • </span>
  
    <a href="/researchNotes/tags.html#summerAFIT" title="Pages tagged summerAFIT" rel="tag" class = "tag"> summerAFIT </a>  &nbsp
  
    <a href="/researchNotes/tags.html#covariance" title="Pages tagged covariance" rel="tag" class = "tag"> covariance </a>  &nbsp
  
    <a href="/researchNotes/tags.html#switchable+constraints" title="Pages tagged switchable constraints" rel="tag" class = "tag"> switchable constraints </a>  &nbsp
  
  

  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="relatedPost">
  <a href="/researchNotes/_projects/summerafit/2017/07/20/Update.html">G.M.M. Sensitivity to Dirichlet Hyperparameter
  </a> <span class = "post-meta"> • July 20, 2017</span>
  
  <span class = "post-meta"> • </span>
  
    <a href="/researchNotes/tags.html#summerAFIT" title="Pages tagged summerAFIT" rel="tag" class = "tag"> summerAFIT </a>  &nbsp
  
    <a href="/researchNotes/tags.html#covariance" title="Pages tagged covariance" rel="tag" class = "tag"> covariance </a>  &nbsp
  
    <a href="/researchNotes/tags.html#switchable+constraints" title="Pages tagged switchable constraints" rel="tag" class = "tag"> switchable constraints </a>  &nbsp
  
  

  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </ul>
  
</div>


<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://https-watsonryan-github-io-researchnotes.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



<div class="wrapper">


<div class = "turn" style = " right: 0px" >
 <a rel = "next" href="/researchNotes/_projects/summerafit/2017/06/02/Update.html"> <span> &rsaquo; </span></a>
</div>





<div class = "turn" style = " left: 0px" >
 <a rel = "prev" href="/researchNotes/_projects/summerafit/2017/05/24/Update.html"> <span> &lsaquo; </span></a>
</div>



</div>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Research Notes</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Research Notes</li>
          <li><a href="mailto:rwatso12@gmail.com">rwatso12@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/watsonryan">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="$grey-color-light" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">watsonryan</span>
            </a>
          </li>
          

          


<li>
  <a href="/researchNotes/feed.xml">
    <span class="icon icon-feed">
      <svg viewBox="0 0 16 16">
      <circle cx="3" cy="13" r="2" fill="$grey-color-light" />
        <path fill="$grey-color-light" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" d="M8.5,14.5"/>
        <path fill="$grey-color-light"  d="M8.708,15c-0.552,0-1-0.447-1-1c0-3.147-2.561-5.708-5.708-5.708c-0.552,0-1-0.448-1-1s0.448-1,1-1
          c4.25,0,7.708,3.458,7.708,7.708C9.708,14.553,9.261,15,8.708,15L8.708,15z"/>
        <path fill="$grey-color-light"  d="M13.469,14.999c-0.553,0-1-0.447-1-1C12.469,8.227,7.772,3.531,2,3.531c-0.552,0-1-0.448-1-1s0.448-1,1-1
          c6.875,0,12.469,5.593,12.469,12.468C14.469,14.552,14.021,14.999,13.469,14.999L13.469,14.999z"/>
      </svg>
    </span>
    <span class="feed"> RSS feed </span>
  </a>
</li>



        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text"></p>

      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0;" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

      <p class="text"><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Research Notes</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://watsonryan.github.io" property="cc:attributionName" rel="cc:attributionURL">Ryan Watson</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>

      </div>



    </div>

  </div>

</footer>


  </body>

</html>
