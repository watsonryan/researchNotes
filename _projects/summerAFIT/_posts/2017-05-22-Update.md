---
title: " M-estimator affect on covariance  "
layout: post
date: "2017-05-22"
author: Ryan Watson 
tags:
  - summerAFIT
  - covariance
  - m-estimator
---

Now that we have several robust optimization techniques implemented, which clearly have a benefit in the positioning domain when compared to $L_2$, we would like to see how these techniques affect the uncertainty in the estimated state. To evaluate this, a simple test case was constructed where only odometery measurements and loop-closure constraints were added to the pose graph. The test graph can be seen below.



<p align="center">
<a href="https://lh3.googleusercontent.com/_EmYa7niXITN0rAVMRtQR0tTJAq_52BR02JrtBeweMfGCDcmGoQVQc5GMsc0q8g8C-YAfu4Ze8hqGaTFXEVKBOsiCVNrUkarL4dF5pLmF1JEGwgItwmRsHbAkXfKcBZt-yItavnO0hNyP30q1cJRG16T6lBiBqaLOOpWBSMQY4mEiyNoj-neGYVLiYFghhdgg8pDoyOsq1zeMCTp6Z-hq2dXgwgrwHZ9T2_OHrky7Xv8IkbnnsORx20ndKFd5kZVzdeFLedAIFYu5z0whIffBaDWuYfk8z4dDjEEYPustqr3_OlG_91g1LDy_hq1t33bbbjIdUf1qFUFjY1zSQs7Mf9DL-buCGfQTgswJE1eQb3Uon9Mrc7fdcSt9MdyK8mTOOWNc000AR2mBHkY9xlW0nqtDkY08kG1sMGW9Vsp0F6o8nGOyUFJYwL8oFdIvAP0Z_arnLn2XRzuGeEqaCKs7vt_Q1dfKR4EUlh5hvCrfzNwSV1rWqjHwtk0ABTyl2ms5lxKdEiN3Te7alwk1p2ZCF5EG6S9DvR9I30mZwLk-SlhyFc0mFkUcI0C_albkX0Rju4ITv7r-McY_DlCz2ZOnQ-MNaJrIsNC4NGGRywYW2kZotAPB5aH=w1024-h538-no" target="_blank"><img src="https://lh3.googleusercontent.com/_EmYa7niXITN0rAVMRtQR0tTJAq_52BR02JrtBeweMfGCDcmGoQVQc5GMsc0q8g8C-YAfu4Ze8hqGaTFXEVKBOsiCVNrUkarL4dF5pLmF1JEGwgItwmRsHbAkXfKcBZt-yItavnO0hNyP30q1cJRG16T6lBiBqaLOOpWBSMQY4mEiyNoj-neGYVLiYFghhdgg8pDoyOsq1zeMCTp6Z-hq2dXgwgrwHZ9T2_OHrky7Xv8IkbnnsORx20ndKFd5kZVzdeFLedAIFYu5z0whIffBaDWuYfk8z4dDjEEYPustqr3_OlG_91g1LDy_hq1t33bbbjIdUf1qFUFjY1zSQs7Mf9DL-buCGfQTgswJE1eQb3Uon9Mrc7fdcSt9MdyK8mTOOWNc000AR2mBHkY9xlW0nqtDkY08kG1sMGW9Vsp0F6o8nGOyUFJYwL8oFdIvAP0Z_arnLn2XRzuGeEqaCKs7vt_Q1dfKR4EUlh5hvCrfzNwSV1rWqjHwtk0ABTyl2ms5lxKdEiN3Te7alwk1p2ZCF5EG6S9DvR9I30mZwLk-SlhyFc0mFkUcI0C_albkX0Rju4ITv7r-McY_DlCz2ZOnQ-MNaJrIsNC4NGGRywYW2kZotAPB5aH=w1024-h538-no" border="0" alt="correctOdo photo odometryTestCorrect_zpsalpe0u7s.png"/></a>
</p>
<p align = "center">
Simple odometry test case 
</p>
<br>

With this simple test case, both $L_2$ and Huber optimization were tested. First, the graph was optimized using the $L_2$ cost function. The optimized graph and covariance of each node can be seen in the figure below.  


<p align="center">
<a href="https://lh3.googleusercontent.com/iQ8lJyg-0QpRxdl3bUxdC02vPya5knHObVna4dvbhZrW9mHqSv8AWbLmzYNfjP0dQCsEP0xFrb6q03_LrWDfXGRTb7-60U7fwkPGvuMGjf-K4fu39sV_VfIxa5VgXfg2uZVGkzlSdbUqvMMox_imC1iKSwe1CSsuuDbe-rCgC8sZk9UNUeJaAXSB4BEGCsxljZpGjuKwoyGOCx0N--wOn3h-faGZuH3xRCwOwARV_CG-GPzs3HtcTmg66kWqksRMFyKAteQs-vjPDMz69nUl9t25qfFGPrTneS7TS30n7lFnUjAgnKtMdnvkmC7BX7Yzstpx3hQ3LmzFITl0TRakBDOIBJWN5SQPc7OTn02u3mDggmKY08DnCLQaHdAVSfeGBCF_TBvpfzjiviEUIrFlhjKQ_L6f4ItchMo8E0D_nZtAoeow_6hn1WQUs0Ohea6pcRIenDTIOIwzZF2Wkh9povJXSZxGZWDRxngUkV342RKux1ojk3WeBY2RJfm8t3hdn9smtEJMyfXdBCvZDDZtw9CU1PWsGjuHyw96cBiPwSCZG_t0-Llaey9Gk_QxORArLrXRssfdwXAObtKfSkREwAGsTb0K0fhABwcO0EeEHobxdfs_26RK=w1024-h538-no" target="_blank"><img src="https://lh3.googleusercontent.com/iQ8lJyg-0QpRxdl3bUxdC02vPya5knHObVna4dvbhZrW9mHqSv8AWbLmzYNfjP0dQCsEP0xFrb6q03_LrWDfXGRTb7-60U7fwkPGvuMGjf-K4fu39sV_VfIxa5VgXfg2uZVGkzlSdbUqvMMox_imC1iKSwe1CSsuuDbe-rCgC8sZk9UNUeJaAXSB4BEGCsxljZpGjuKwoyGOCx0N--wOn3h-faGZuH3xRCwOwARV_CG-GPzs3HtcTmg66kWqksRMFyKAteQs-vjPDMz69nUl9t25qfFGPrTneS7TS30n7lFnUjAgnKtMdnvkmC7BX7Yzstpx3hQ3LmzFITl0TRakBDOIBJWN5SQPc7OTn02u3mDggmKY08DnCLQaHdAVSfeGBCF_TBvpfzjiviEUIrFlhjKQ_L6f4ItchMo8E0D_nZtAoeow_6hn1WQUs0Ohea6pcRIenDTIOIwzZF2Wkh9povJXSZxGZWDRxngUkV342RKux1ojk3WeBY2RJfm8t3hdn9smtEJMyfXdBCvZDDZtw9CU1PWsGjuHyw96cBiPwSCZG_t0-Llaey9Gk_QxORArLrXRssfdwXAObtKfSkREwAGsTb0K0fhABwcO0EeEHobxdfs_26RK=w1024-h538-no" border="0" alt="noFalseConstraintL2 photo noFalseConstraint_zpsnepnrnte.png"/></a>
</p>
<p align="center">
$L_2$ optimization with no false constraints 
</p>
<br>


Next, the Huber robust noise model was utilized. Again, the optimized graph and associated covariance of each node can be seen in the figure below. As would be expected, there is no substantial difference between the optimized solutions.


<p align="center">
<a href="https://lh3.googleusercontent.com/cKYHt_Yr4Nm538MHBsbyB3BHfmvapRyCXcvjdXZ0diR3aVRvqt89oRJfF4Xs7z83ZOXYzzzlqLLME8TgX25H-zbg6hZYoUNzJTictGgDuYPRsr1ZIk_9vESRP87BppEsh3Pbp8389a2HyZJLe4zJRRsekYOYOKWoyklDTs56JHN1AYB5QJ4PWP_aAF8pMD1dmi_XzrefeH-itq6Fo_v2o58wDq2XOLDOJKlyil5QNyZ2ydM6XxcDtwtJPhVZjlcD0Jnk3oRuRz94SZ0WAisro-olHyua4Jr7kzXGrjBtuCauo8zOsLgI4j27Y5-8lc8lUqlU9Lqq_TC_oaM6CpeMZv2ELO8zu3cuTFl8EBm2eDQvMtl8Fu-1-3H-VfyDUoYo5wJKKNfJt1lZRP6msfsTd3bjCpv5r7Q1RrYqnBaeiE7QAvEZWDg-zFubSLXwQ30vYvBtll0q4cFEs7R1jidQm7XqwelEcnTkiwUqv2kdSElhZkUsxOn2sMfYv0km1CwAt2aKSoLV3XRJH_g6s_zFbLsz0DZQucBgVhb_EvLRoY-wjfN-btxxTzNbId5VVncjAl8szf_MIdM=s1024-w1024-h538-no" target="_blank"><img src="https://lh3.googleusercontent.com/cKYHt_Yr4Nm538MHBsbyB3BHfmvapRyCXcvjdXZ0diR3aVRvqt89oRJfF4Xs7z83ZOXYzzzlqLLME8TgX25H-zbg6hZYoUNzJTictGgDuYPRsr1ZIk_9vESRP87BppEsh3Pbp8389a2HyZJLe4zJRRsekYOYOKWoyklDTs56JHN1AYB5QJ4PWP_aAF8pMD1dmi_XzrefeH-itq6Fo_v2o58wDq2XOLDOJKlyil5QNyZ2ydM6XxcDtwtJPhVZjlcD0Jnk3oRuRz94SZ0WAisro-olHyua4Jr7kzXGrjBtuCauo8zOsLgI4j27Y5-8lc8lUqlU9Lqq_TC_oaM6CpeMZv2ELO8zu3cuTFl8EBm2eDQvMtl8Fu-1-3H-VfyDUoYo5wJKKNfJt1lZRP6msfsTd3bjCpv5r7Q1RrYqnBaeiE7QAvEZWDg-zFubSLXwQ30vYvBtll0q4cFEs7R1jidQm7XqwelEcnTkiwUqv2kdSElhZkUsxOn2sMfYv0km1CwAt2aKSoLV3XRJH_g6s_zFbLsz0DZQucBgVhb_EvLRoY-wjfN-btxxTzNbId5VVncjAl8szf_MIdM=s1024-w1024-h538-no" border="0" alt="NoFalseConstaintHuber photo noFalseConstraintHuber_zpsxg0lnur1.png"/></a>
</p>
<p align="center">
Huber optimization with no false constraints 
</p>
<br><br>



Now, a false loop-closure constraint is added between nodes two and four --- the optimizer believes that these nodes should be zero meters apart with an uncertainty of 0.2 meters on position. The new initial pose graph is depicted below.


<p align="center">
<a href="https://lh3.googleusercontent.com/_IUj34MePwYh8UehoEXmsRGDAYQoFBeZv8ntvhgrhLbVKQ70uexImVplPy1S86ku95c5v0_-bcecL8YGMO0T7upXBIWy3iehDg8Rmd1g_m1YLVEYkCO8Q1w5cKyT5z_8lghS4afx0mUlrSC4EuyivfpfDjqAXOMRwjqHI8XNiR-TTwXPN3gGIoKSVZybC38BzSOfSWP-09q-g7EcaYb-w5ohqZMHtx64tiHBld121vpiHw3pm7_9bzs4FASNTa3wHOpb8p33jeI7-KBnvYK7y0gUzbrVHzAoIyccDLnACL0TAmXJ9PTnd9YT7MuM1AmaADAKVfPb5H4G7OfO97fcS9IG2JAjXN_aZ4wTdNftNynBKg-qUVXJSp5kGk_6FGQa5ARNx9hlm0WGOAHBPdXygjQZ9Z3n4ON8rwEIp6n3nB7bd-A3tjLGtNElgY89oKTzcOvilMsLGVVD6EylOXAt6XxSvtg-8ACcOf_Ul5RojRhPsNPdMbxslkqPyVSZP68SL2uMWZx7yAo7HjPTAazWlYJixn6--_L5fJMqa2lOZbcA6-kJiV6jDoIcLSrL37e3MymfRZlE3lWZwIJa491ADAZ1s1azRxdjm9dOBsjsjQ5_CadLlnCQ=w1024-h538-no" target="_blank"><img src="https://lh3.googleusercontent.com/_IUj34MePwYh8UehoEXmsRGDAYQoFBeZv8ntvhgrhLbVKQ70uexImVplPy1S86ku95c5v0_-bcecL8YGMO0T7upXBIWy3iehDg8Rmd1g_m1YLVEYkCO8Q1w5cKyT5z_8lghS4afx0mUlrSC4EuyivfpfDjqAXOMRwjqHI8XNiR-TTwXPN3gGIoKSVZybC38BzSOfSWP-09q-g7EcaYb-w5ohqZMHtx64tiHBld121vpiHw3pm7_9bzs4FASNTa3wHOpb8p33jeI7-KBnvYK7y0gUzbrVHzAoIyccDLnACL0TAmXJ9PTnd9YT7MuM1AmaADAKVfPb5H4G7OfO97fcS9IG2JAjXN_aZ4wTdNftNynBKg-qUVXJSp5kGk_6FGQa5ARNx9hlm0WGOAHBPdXygjQZ9Z3n4ON8rwEIp6n3nB7bd-A3tjLGtNElgY89oKTzcOvilMsLGVVD6EylOXAt6XxSvtg-8ACcOf_Ul5RojRhPsNPdMbxslkqPyVSZP68SL2uMWZx7yAo7HjPTAazWlYJixn6--_L5fJMqa2lOZbcA6-kJiV6jDoIcLSrL37e3MymfRZlE3lWZwIJa491ADAZ1s1azRxdjm9dOBsjsjQ5_CadLlnCQ=w1024-h538-no" border="0" alt="incorrectOdo photo odometryTestCorrect_zpsgtdn0vsr.png"/></a>
</p>
<p align="center">
Odometry test case with one false loop-closure 
</p>
<br>


Using the pose graph with a false loop-closure constraint as depicted above, $L_2$ optimization is performed again. When processing a graph that containts faults, it can clearly be seen in the figure below that the position solution is skewed by the false constraint; however, this does not correspond to a substantially larger uncertainty in the estimated state.

<p align="center">
<a href="https://lh3.googleusercontent.com/BeovodOSpwpi-sCiVEMs2Ou6PBbK0BFp1nbIKY7r3DVI5bk_XnPEZ-AK2n_e5gR09EIKU6Y5ZDMG8qrPZQ5PHykgggCgdSICZEo3XrqfibGG_NJvtfHLPH-2Z5ssccf65119Zz2wKY9jc9PqZJk_L_8Da8RejdorTQMTvPg6XA5M9nxX2K4SHQVU1wDXBU1M3rVxBox6hP-dzGluwRSq1piNxvzusUbVbIiW1PaiJLsPVeWYHuPlp3n2gq90G2ai_uyQ88ac0hxZMOwDoJTXtiSY0TLw6GOEVpiibUnO7cSSv0nBIe4GHB8LHSZJ44PySxLEMzH9yjpz0JgZUNwhx3a3g1OI4vFHEvGYKGh7ye_6kdYzdvFxjgIGestuU9v0VRo5VcQQ_Jm1PIfUbPJyFn1x4ezGrD2nn2f9LX14dqSRngUj9vyCQ4ws1QsWSZhTodAv5U-Q2nRrGPsirMcgR4L6NNkhbbltK3LHasymAYmxbD4j8ll00Q8ZBk75n_aqLeXaiOGFo7Qo0L3MYSxowNcymxRuwi5nsh_r8qFjWKGytDh4EzKX6Mq4VCOEItln2bEMiOplMHLoGS_h0XVj6-i2iZIt1tgViClsWEOnCJVl0yqFkLYU=w1024-h538-no" target="_blank"><img src="https://lh3.googleusercontent.com/BeovodOSpwpi-sCiVEMs2Ou6PBbK0BFp1nbIKY7r3DVI5bk_XnPEZ-AK2n_e5gR09EIKU6Y5ZDMG8qrPZQ5PHykgggCgdSICZEo3XrqfibGG_NJvtfHLPH-2Z5ssccf65119Zz2wKY9jc9PqZJk_L_8Da8RejdorTQMTvPg6XA5M9nxX2K4SHQVU1wDXBU1M3rVxBox6hP-dzGluwRSq1piNxvzusUbVbIiW1PaiJLsPVeWYHuPlp3n2gq90G2ai_uyQ88ac0hxZMOwDoJTXtiSY0TLw6GOEVpiibUnO7cSSv0nBIe4GHB8LHSZJ44PySxLEMzH9yjpz0JgZUNwhx3a3g1OI4vFHEvGYKGh7ye_6kdYzdvFxjgIGestuU9v0VRo5VcQQ_Jm1PIfUbPJyFn1x4ezGrD2nn2f9LX14dqSRngUj9vyCQ4ws1QsWSZhTodAv5U-Q2nRrGPsirMcgR4L6NNkhbbltK3LHasymAYmxbD4j8ll00Q8ZBk75n_aqLeXaiOGFo7Qo0L3MYSxowNcymxRuwi5nsh_r8qFjWKGytDh4EzKX6Mq4VCOEItln2bEMiOplMHLoGS_h0XVj6-i2iZIt1tgViClsWEOnCJVl0yqFkLYU=w1024-h538-no" border="0" alt="falseConstNonRobust photo falseConstraintNonRobust_zpsfbfunf04.png"/></a>
</p>
<p align="center">
$L_2$ optimization with false constraint
</p>
<br>

Optimizing the same graph with the Huber noise model shows substancial imporvement with respect to positioning accuracy when compared to $L_2$ optimization. Additionally, the uncertainty in the state is increase, which is desired. 

<p align="center">
<a href="https://lh3.googleusercontent.com/IqYRQGWZ3eEmLltPlacNLMkHrsykxFoE68FbidLt2XLdjYNJ9r0RzIIxE6UL1CJXTg4AaNEPjoiqZcoggyh_ouZn7A4nsHoNqPmYOCW5gx2SmWcs4TsvzkMOLxtcVqZ0M5hr2ok6gntIPU6qab2-U8Qi4PluNdE1df-sPbvvN7ENPFKrvB3gkZtbvfSv4TB5VVi9iy_8i-kTEecK9Y6qxHl6rEwlEFd7OluuYm6tPs19pKJvPCY70qD1wlUQKzgdWjBfVi8fDwoP-ScLTVny2z7R9E5NDj13BAa7H8Rs_xCQKqGLLjtRxx0w04rSEeJjZGGBSu74-UKJ0paIwL91WFOn_2bHJ8OKPL9KfR1Qpyi79mIYb1c2PyghH9gyipmaN2jMQdxkh8X-lFBGhDKiKp12HqMtxpfRPvQX8d4GQ5zhybPMpmrMTSye8jMmLiTM-QpywQ7ywOYfYRwZtvuO_XHFRmuXrfnmUYb_IMEkB0HNlJrsb3fanJENV3Zpp4O-VkjAnSHHrW1a9gcTFr0NwNU___XQXGqK133qzs0tG0AadWlnq0mZGR0X1VfokgugM6W_5jpnX8aRJqRuMi3htVjQ2I4aFXoskCs9Kk9G_neBaxQ64ac1=w1024-h538-no" target="_blank"><img src="https://lh3.googleusercontent.com/IqYRQGWZ3eEmLltPlacNLMkHrsykxFoE68FbidLt2XLdjYNJ9r0RzIIxE6UL1CJXTg4AaNEPjoiqZcoggyh_ouZn7A4nsHoNqPmYOCW5gx2SmWcs4TsvzkMOLxtcVqZ0M5hr2ok6gntIPU6qab2-U8Qi4PluNdE1df-sPbvvN7ENPFKrvB3gkZtbvfSv4TB5VVi9iy_8i-kTEecK9Y6qxHl6rEwlEFd7OluuYm6tPs19pKJvPCY70qD1wlUQKzgdWjBfVi8fDwoP-ScLTVny2z7R9E5NDj13BAa7H8Rs_xCQKqGLLjtRxx0w04rSEeJjZGGBSu74-UKJ0paIwL91WFOn_2bHJ8OKPL9KfR1Qpyi79mIYb1c2PyghH9gyipmaN2jMQdxkh8X-lFBGhDKiKp12HqMtxpfRPvQX8d4GQ5zhybPMpmrMTSye8jMmLiTM-QpywQ7ywOYfYRwZtvuO_XHFRmuXrfnmUYb_IMEkB0HNlJrsb3fanJENV3Zpp4O-VkjAnSHHrW1a9gcTFr0NwNU___XQXGqK133qzs0tG0AadWlnq0mZGR0X1VfokgugM6W_5jpnX8aRJqRuMi3htVjQ2I4aFXoskCs9Kk9G_neBaxQ64ac1=w1024-h538-no" border="0" alt="falseConstraintHuber photo falseConstraintHuber_zpspzt0omjk.png"/></a>
</p>
<p align="center">
Huber optimization with false constraint
</p>
<br> <br>

### These results will be validated tomorrow with more robust noise models being tested.

<br><br>
