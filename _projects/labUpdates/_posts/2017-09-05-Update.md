---
title: "Initial Testing Of Topologicial Pose Graph Optimization"
author: Ryan Watson
date: "2017-09-05"
tags:
 - labUpdates
 - Topological Data Analysis
 - Pose Graph Optimization
 - TDA
---

<br><br>

Conducting inference over a factor graph when all measurements accurately constrain their states is well studied. With the assumption that the measurement and motion models can be approximated by a uni-modal Gaussian, the optimization can be simplified to a traditional least-squares optimization, as depicted in Eq. 1. 

$$	x^{*} = (H^{T}WH)^{-1}H^{T}W(y-Hx)  $$


However, collected data sets for navigation applications are rarely well approximated by the simplified uni-modal Gaussian model. For example, consider the data set depicted in Fig 1. Figure 1 depicts the commonly used Manhattan 3500 data set, which is composed of 3500 pose estimates and 5,598 range measurements. The right-hand side of Fig. 1 depicts the data set with no false constraints present, while the left-hand side depicts the data set when 100 false constants are included.

When presented with a data set that contains erroneous constants, such as the on depicted in Fig. 1, without accurate models, the  traditional least-squares optimization breaks down. This can be depicted by taking an arbritary measurement $y_i$ and letting its magnitude approach infinity, $\lvert \lvert y_i \rvert \rvert \rightarrow \infty$. Now, if we examine Eq. \ref{ls} we can see that as $\lvert \lvert y_i \rvert \rvert \rightarrow \infty$,  $\lvert \lvert x^{*} \rvert \rvert \rightarrow \infty$. This shows that a least-squares estimator, using the $L^2$ cost function, can not handle an arbitrarily large measurement, which shows that it has a break-down point of 0.

<br>
<p align="center">
<a href="https://lh3.googleusercontent.com/w-vkVpaL3QNg_B3gjcEUl24JP2vj-NM8K0SdQELFgqjW21tljctaspeid3pJNJlOrAhZgUSWa0MtkJfNMeHZjC0UL8Bix_awcDB0m2jMKlCL06QeaHaC2zdz-GzxF-a2l7J5VJRkIAzHhYK3V5QEb8TiH3jG5s6EwsSwdwBFJagUfOmbI-DLqrPrqpgosOFEYaCtVtqq0ds_y_Ez5Vyl77eFT3UzkPv1oSK1LnbpPwRtL7TvHBJJRfqGNqY9jDWS2tRW8CMkMS3oBqAff0HF7Sl3-0hT9uj0kHYjpF4MvNrhEm4-NI4eM0dKgrz9o2Mqlhxa8pSC4SaKrewZ2JAA1N6tOm_I1_DRWI8CADIMRKH6pxcHIZ6lVwFrE0tQ-TzP8686Jvtglrnv2ad-M3fQS-lZj-o8MnDRjaMJl62pGJoVxgJ9J1KK3jc6XAQOdH6qsY9amr6oG6RwCh2oaIkbx9oiDCdBC_y9XDQnY4ovx1fKGbNhFxl9sB1Ed4GtsJAmUrx84QRDtc9yFPWiKBUQKZUOyLLMax5GlYZd4mkZK7eXquQ81XcOMMmY9ozNKNWFBwv8v_AqTVirWnYIgo0tsse9jDhfXuXVwj5AO9KP7lLkfisjOyYL6w4YPwsx6CStYx34VtUTrewmWBrSSZ_9j2nuGTQlz_vWF0dRIKul0BtFYA=w1094-h359-no" target="_blank"><img src="https://lh3.googleusercontent.com/w-vkVpaL3QNg_B3gjcEUl24JP2vj-NM8K0SdQELFgqjW21tljctaspeid3pJNJlOrAhZgUSWa0MtkJfNMeHZjC0UL8Bix_awcDB0m2jMKlCL06QeaHaC2zdz-GzxF-a2l7J5VJRkIAzHhYK3V5QEb8TiH3jG5s6EwsSwdwBFJagUfOmbI-DLqrPrqpgosOFEYaCtVtqq0ds_y_Ez5Vyl77eFT3UzkPv1oSK1LnbpPwRtL7TvHBJJRfqGNqY9jDWS2tRW8CMkMS3oBqAff0HF7Sl3-0hT9uj0kHYjpF4MvNrhEm4-NI4eM0dKgrz9o2Mqlhxa8pSC4SaKrewZ2JAA1N6tOm_I1_DRWI8CADIMRKH6pxcHIZ6lVwFrE0tQ-TzP8686Jvtglrnv2ad-M3fQS-lZj-o8MnDRjaMJl62pGJoVxgJ9J1KK3jc6XAQOdH6qsY9amr6oG6RwCh2oaIkbx9oiDCdBC_y9XDQnY4ovx1fKGbNhFxl9sB1Ed4GtsJAmUrx84QRDtc9yFPWiKBUQKZUOyLLMax5GlYZd4mkZK7eXquQ81XcOMMmY9ozNKNWFBwv8v_AqTVirWnYIgo0tsse9jDhfXuXVwj5AO9KP7lLkfisjOyYL6w4YPwsx6CStYx34VtUTrewmWBrSSZ_9j2nuGTQlz_vWF0dRIKul0BtFYA=w1094-h359-no" border="0" alt=" photo imgonline-com-ua-twotoone-XEN5fUgMoaSc_zpsliygmo1g.jpg"/></a>
</p>
<p align="center">
Fig 1 :: Manhattan 3500 data set   
</p>
<br><br>

Several methodologies have been proposed to handle erroneous constants within $L^2$ optimization framework. The most commonly used is the M-estimator, which attempts to mitigate the contribution of false constraint by replacing the quadratic cost function with a modified cost function beyond a user-defined threshold. One obvious drawback to this method, and most other proposed methods, is the need to define a model $a-priori$. The model should be adaptive (i.e., not be dependent upon user defined inputs and vary with respect to the current data set).

To create a framework that is both adaptive and robust, we plan to utilize the recent advance within the field of [topological data analysis (TDA)](https://www.colby.edu/math/program/honorsprojects/2016-Murphy-HonorsThesis.pdf).  TDA allows for the efficient clustering of high-dimensional data, this provides an ideal framework for outlier rejection. To depict this, the residuals from $L^2$ optimization of the Manhattan data set with 100 false constraints was classified with the [topological mapper](https://research.math.osu.edu/tgda/mapperPBG.pdf). A depicting of the  clustering is provided in Fig. 2, where the mapper found 13 clusters with 2 main subsets. Figure 3 shows just the residuals that are contained within the largest cluster (i.e., the inlier distribution).

<br>
<p align="center">
<a href="https://lh3.googleusercontent.com/ckcGQq3V0IifpjiPZVtDhntgaKTnpfa58gR5P5vq8Wbjmbu6dlaJfrN1V_rY6mfG7ihQZZ1wbvm8M2vHV5qBbExf3pNeFrLryCkrEEDtQSlR-04y4nLqMaU-HMH6_ArXqusGF0-2WzuG2ioh1J_5JVZ1E8JewT1oYKQKE408fB8dqlN1XW71UfcfcZ2LXw-JGqIJuy_UHtvGnr6uIXr1oas4RJP6qxts_s27jZvyhbY8SSpoBsUOo_551RbARhYW682U7qqAzJSV--C9MaMh_0kLOQ4k8-qqliRBDMUJKCVgZsEyEKbfanIi268b0oRHA-ijyVFdfmP2iMo0kt69qgpWz27m85vcVy2eFOEM6Qn1wP5_w9xuB-3m_lnV4jaJHIej8SvNarWtJLIFdIGFAJtyMvkyHsnntSFax8eNQVhNUBCPsBEs-s2d_Xe8_E0Fke9YQKM4ruGxQNPGFfobJsEMJUavjM4yP4c7cobNmpRZHzNO4W6yd9HbNpfcuvGDsi1tqJhlkCmn1oIhLP1jn8pUA9FDhaA5Dq5CmH3vT-F1byDjMNvSqwSx5yN07Gep3_Z-fJv4_hsqJ_kOiauhPlWsbgKaVWtOjF3U-wJlIW8cjwruDKoGlu2M19yXkyPfkW2YCbv93HdTBNP9U1jRfmGPI1XkWVo3yT5Ay6w6jQ09vA=w1094-h338-no" target="_blank"><img src="https://lh3.googleusercontent.com/ckcGQq3V0IifpjiPZVtDhntgaKTnpfa58gR5P5vq8Wbjmbu6dlaJfrN1V_rY6mfG7ihQZZ1wbvm8M2vHV5qBbExf3pNeFrLryCkrEEDtQSlR-04y4nLqMaU-HMH6_ArXqusGF0-2WzuG2ioh1J_5JVZ1E8JewT1oYKQKE408fB8dqlN1XW71UfcfcZ2LXw-JGqIJuy_UHtvGnr6uIXr1oas4RJP6qxts_s27jZvyhbY8SSpoBsUOo_551RbARhYW682U7qqAzJSV--C9MaMh_0kLOQ4k8-qqliRBDMUJKCVgZsEyEKbfanIi268b0oRHA-ijyVFdfmP2iMo0kt69qgpWz27m85vcVy2eFOEM6Qn1wP5_w9xuB-3m_lnV4jaJHIej8SvNarWtJLIFdIGFAJtyMvkyHsnntSFax8eNQVhNUBCPsBEs-s2d_Xe8_E0Fke9YQKM4ruGxQNPGFfobJsEMJUavjM4yP4c7cobNmpRZHzNO4W6yd9HbNpfcuvGDsi1tqJhlkCmn1oIhLP1jn8pUA9FDhaA5Dq5CmH3vT-F1byDjMNvSqwSx5yN07Gep3_Z-fJv4_hsqJ_kOiauhPlWsbgKaVWtOjF3U-wJlIW8cjwruDKoGlu2M19yXkyPfkW2YCbv93HdTBNP9U1jRfmGPI1XkWVo3yT5Ay6w6jQ09vA=w1094-h338-no" border="0" alt=" photo imgonline-com-ua-twotoone-XEN5fUgMoaSc_zpsliygmo1g.jpg"/></a>
</p>
<p align="center">
Fig 2 :: Topological Mapper Clustering on Manhattan 3500 Data Set   
</p>
<br><br>

<br>
<p align="center">
<a href="https://lh3.googleusercontent.com/-w4vDCtLUu5tjtVdCIOBrdXgSWfwcZo9p6wijxH-XQG33Wbn40TmqtjEwrfqLMKwYiOxzeoIxE10-Z-g3QouomoJ5JRN0ygdFiNi9Xba2ZpzkYRv3XO0H9BNiQLvCyxQZKdIcENt3ueZb39ZBu1zUWu9i5rr6TYC8WJAPIoD2rQ_nAmeCX62PWXJWkzu-YtceWrsHB_XCTpWM6yNh-fmWmrvwtVGeme4_xtNAxsHV2NiLI6WaH46-ioSvYLX7KBmuzQ8XoixOq8KYsLOIr5XGXMt3vwl4Rc6Pq9rnRDy_-Yk6DIWpR8BJFU3XEGYzhV_TckToPENASLR2AA0F9ADqx59UHNKYXXCKVNRGmQ1DNPMnENAlA3A7iM4eRMKBRFBvEh1W75fdXvFkzjUc2AT3lho-VeP5brdSdxj4U39gmfAuIC6azus9Yn_F-oJUKo_RiTqwSzOYFWUo_C_0bKCzB4xRD9LSMh7UZOssVbj4-_NCcqRxRZtXkD3SihDzIx09Qe46pzUluJkRdlrcn6I3CfJEY-Atg75y1SVXtl91tGO1vBzTNW5tOZn4JPpwK9Y1KAK9CxJ9bk5ajulPXSKqgO7odGW8s9K_PfiDyhFZFX-njH4dZB4_O8R-kl__tFiDJkZJMqgqUCci3PU627h_jU3Hk_L5H8UfokXOlP7ig9aNA=w1094-h338-no" target="_blank"><img src="https://lh3.googleusercontent.com/-w4vDCtLUu5tjtVdCIOBrdXgSWfwcZo9p6wijxH-XQG33Wbn40TmqtjEwrfqLMKwYiOxzeoIxE10-Z-g3QouomoJ5JRN0ygdFiNi9Xba2ZpzkYRv3XO0H9BNiQLvCyxQZKdIcENt3ueZb39ZBu1zUWu9i5rr6TYC8WJAPIoD2rQ_nAmeCX62PWXJWkzu-YtceWrsHB_XCTpWM6yNh-fmWmrvwtVGeme4_xtNAxsHV2NiLI6WaH46-ioSvYLX7KBmuzQ8XoixOq8KYsLOIr5XGXMt3vwl4Rc6Pq9rnRDy_-Yk6DIWpR8BJFU3XEGYzhV_TckToPENASLR2AA0F9ADqx59UHNKYXXCKVNRGmQ1DNPMnENAlA3A7iM4eRMKBRFBvEh1W75fdXvFkzjUc2AT3lho-VeP5brdSdxj4U39gmfAuIC6azus9Yn_F-oJUKo_RiTqwSzOYFWUo_C_0bKCzB4xRD9LSMh7UZOssVbj4-_NCcqRxRZtXkD3SihDzIx09Qe46pzUluJkRdlrcn6I3CfJEY-Atg75y1SVXtl91tGO1vBzTNW5tOZn4JPpwK9Y1KAK9CxJ9bk5ajulPXSKqgO7odGW8s9K_PfiDyhFZFX-njH4dZB4_O8R-kl__tFiDJkZJMqgqUCci3PU627h_jU3Hk_L5H8UfokXOlP7ig9aNA=w1094-h338-no" border="0" alt=" photo imgonline-com-ua-twotoone-XEN5fUgMoaSc_zpsliygmo1g.jpg"/></a>
</p>
<p align="center">
Fig 3 :: Estimated Inlier Distribution From Topological Mapper   
</p>
<br><br>


We can take an inital look at the robustness granted by the topological mapper. As a comparison, we will first look at the optimization using $L^2$. The final optimized pose graph using $L^2$ optimization is depicted in Fig. 4 on the left-hand side. As shown, the optimization breaks down, and does not resemble the true optimized graph, as depicted in Fig. 1. Now, we can test the topological mapper optimization by only including constraints in the optimization that are classified as inliers. The topological mapper optimization is depicted in Fig. 4 on the right-hand side. Through visual comparison, it can be seen to be more robust to erroneous constants than $L^2$ optimization; however, more research is required to make it comparable to state-of-the art techniques.


<br>
<p align="center">
<a href="https://lh3.googleusercontent.com/TFU8SbclPsX6vz2omC_uY5JDLPkH-JcfIOpCZHjZ22N21hsbqta7Hk4JHJ1WvdhndN8opVOhtraJTH2VhF0gXiGp8CCCtsmVpsBhePTwwkn_zkgNDRnqqfXSaBjViQb6ld4bMQL9f_bNSrd8KUNlkB0g0dG2DxQe6nBPj_xE1c0XEEvFtaaMdtRAcYMIV6zbs0fR4Mk9_wtQFPjd8Bffwq1KE1P3qUIOKS_KEIMwrHbKqhydEnf9C8l4fqEknNDhcY9rcINunZF10WebGze8ZokLj5f_cPZbf3zW19JfWcq1zz5gdC1v6iFM9-MBot-qbbYOl6kIOzuo4Ukr4M5yFtI-nzx0NG4kOTEJ8cM3muW69DLc55y3mGHgvdUZegsG7-giweC-N9xxjrpU90anVGnrfKWBmV4yHi0qp8shn0Bt9qJHbJs0UrlVxPQXfD_Iw89zJqk4DDllCuCvMYpX58O1TC8oVlnhPDluxAUc9KgIz12XV0hX0IiJU5ADrfu3JtS2A1q_NXrV9LAun5bF1m5MIkbLYU4-PP3fYgH-2g1SAlzyKXYmIDw-FcUrGEkLB6CvJYG8NzmCNPrfPkl-nqQ-rjzwFYJ_RUld59eYAGNd0IEB0AxvFNz-8f4t0MA2yaWIGW8AwVsRffiwDv8wHJUbAJY-2gyv6wKMJI7jOhXStw=w1094-h283-no" target="_blank"><img src="https://lh3.googleusercontent.com/TFU8SbclPsX6vz2omC_uY5JDLPkH-JcfIOpCZHjZ22N21hsbqta7Hk4JHJ1WvdhndN8opVOhtraJTH2VhF0gXiGp8CCCtsmVpsBhePTwwkn_zkgNDRnqqfXSaBjViQb6ld4bMQL9f_bNSrd8KUNlkB0g0dG2DxQe6nBPj_xE1c0XEEvFtaaMdtRAcYMIV6zbs0fR4Mk9_wtQFPjd8Bffwq1KE1P3qUIOKS_KEIMwrHbKqhydEnf9C8l4fqEknNDhcY9rcINunZF10WebGze8ZokLj5f_cPZbf3zW19JfWcq1zz5gdC1v6iFM9-MBot-qbbYOl6kIOzuo4Ukr4M5yFtI-nzx0NG4kOTEJ8cM3muW69DLc55y3mGHgvdUZegsG7-giweC-N9xxjrpU90anVGnrfKWBmV4yHi0qp8shn0Bt9qJHbJs0UrlVxPQXfD_Iw89zJqk4DDllCuCvMYpX58O1TC8oVlnhPDluxAUc9KgIz12XV0hX0IiJU5ADrfu3JtS2A1q_NXrV9LAun5bF1m5MIkbLYU4-PP3fYgH-2g1SAlzyKXYmIDw-FcUrGEkLB6CvJYG8NzmCNPrfPkl-nqQ-rjzwFYJ_RUld59eYAGNd0IEB0AxvFNz-8f4t0MA2yaWIGW8AwVsRffiwDv8wHJUbAJY-2gyv6wKMJI7jOhXStw=w1094-h283-no" border="0" alt=" photo imgonline-com-ua-twotoone-XEN5fUgMoaSc_zpsliygmo1g.jpg"/></a>
</p>
<p align="center">
Fig 4 :: Traditional $L^2$ Optimization Compared To Optimiziation With Topological Mapper   
</p>
<br><br>

## Next Steps 

1) Test on simulated GNSS data


