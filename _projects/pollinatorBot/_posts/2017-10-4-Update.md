---
title: "Occupancy Grid Generation"
author: Ryan Watson
date: "2017-10-04"
tags:
 - pollinatorBot
 - bumble bot
 - blam test
 - occupancy grid 
---

## Occupancy Grid Generation from 3D SLAM Map 

To test our ability to generate an accurate occupancy grid, we will utilize the data-set collected in the green house on 10/3/17. For now, we are only concerned with a 2d occupancy grid to simplify the planning algorithms. To construct a 2d occupancy grid we can compress the 3d structure generated by our SLAM algorithm, as shown in the first video, into a 2d occupancy grid.

<br>
<p align="center">
<iframe width="640" height="360" src="https://www.youtube.com/embed/xc8gBKzkVDM" frameborder="0" allowfullscreen></iframe>
</p>
<br><br>
<p align="center">
SLAM solution with new greenhouse dataset 
</p>
<br>

Initially we tried to compress the whole 3d structure to generate an occupancy grid as provided in the second video. As can be seen, the quality of the generated occupancy grid is of poor quality.

<br>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/V52x5girnSs" frameborder="0" allowfullscreen></iframe>
</p>
<br><br>
<p align="center">
First attempt at occupancy grid generation 
</p>
<br>

In an attempt to generate a higher fidelity occupancy grid, we can restrict the amount of the 3d structure that we compress (i.e., we know that robot's height, so we don't need to be concerned about occupied grid points above it). Using this technique the cost map was generated again, as provided in the third video. As can be seen, this map is much high fidelity. 

<br>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/DRhahWNKARo" frameborder="0" allowfullscreen></iframe>
</p>
<br><br>
<p align="center">
Second attempt at occupancy grid generation 
</p>
<br>

### Next Steps :

Next, I will try to do some clustering over the occupancy grid and calculate the convex hull of each blob to make it an easier environment for path planning. 
<br><br>


## GNSS Data 


In addition to lidar, we also have a NovAtel SPAN system on board, which collectes GNSS/INS observables. To extract the NovAtel data from the ROS bag, the following three commands can be utilized, where the final file, gps.bin, can be converted to a RINEX file with NovAtels conversion software.

~~~ bash
$ rostopic echo -b ~/path/to/file -p /gps_data > gps.data
$ cd $WVUPNG
$ ./bin/rosBagToBin.py -i gps.data -o gps.bin
~~~

For some reason, on this data collect, we did not get a GNSS fix; however, we did collect INS data. 

<p align="center">
<a href="https://lh3.googleusercontent.com/jXTFq9aHQgN2i11DR0uuXoRFarQQCFwHsHfI1nbfetSLOdRQU5_hOXCgwGRbjilITjuKoyPABVJFD67tCZoRMdVGsi2cujaDEy72p4TqwP88yWnM_OMIwutMzapYtOLe-5rSb_Mr5TTmXK7xMYFzb8D2ndOBIJTJ16aMm9gvCrVAzvKTj3ZN_v8WKz8iKeQeKTbOv2ED3z4boUHlZAXr9G1jKglLOzHT9FRbnAtvuYrveeBxG0bEZ4XcEd5r2AZAot-t_MU-uNgTePMDaubf02Z9otv23zY0pUv6j7TWE79SQA-HsArgVxKOHDpLBVPQIg_9WHj-bV1NkhzVo0H19nr0RZWnMgB-1cajAajSi45p3FYBPt5ZlpRycYDdAOadQbjZzIFL3k87zgfXHwXFLbCn3w1rD_ILNfJIwAhWRJr9yHZxiawFYJUo1vEV1ZWBmIEzIk-Sv7WxoAAa1nJHO9317RltQgq78FPepkLM1Um-ecRFi7d0tUgsYOLtkLv2twLQK8PprwtaP3CUrlzbVUczw-bStPIizncyiesnWiS4AeKLH6tpdc56QU-0YMpiEIZq5wuhXAYVhLMtzuNvAF6TbosuGRe-vcH7sxD2Yx8889gu2nOYf841sseYFgo7t3vAQcdHckojW0zLX-6ADJGcKa_8KD0KO9c=w652-h168-no" target="_blank"><img src="https://lh3.googleusercontent.com/jXTFq9aHQgN2i11DR0uuXoRFarQQCFwHsHfI1nbfetSLOdRQU5_hOXCgwGRbjilITjuKoyPABVJFD67tCZoRMdVGsi2cujaDEy72p4TqwP88yWnM_OMIwutMzapYtOLe-5rSb_Mr5TTmXK7xMYFzb8D2ndOBIJTJ16aMm9gvCrVAzvKTj3ZN_v8WKz8iKeQeKTbOv2ED3z4boUHlZAXr9G1jKglLOzHT9FRbnAtvuYrveeBxG0bEZ4XcEd5r2AZAot-t_MU-uNgTePMDaubf02Z9otv23zY0pUv6j7TWE79SQA-HsArgVxKOHDpLBVPQIg_9WHj-bV1NkhzVo0H19nr0RZWnMgB-1cajAajSi45p3FYBPt5ZlpRycYDdAOadQbjZzIFL3k87zgfXHwXFLbCn3w1rD_ILNfJIwAhWRJr9yHZxiawFYJUo1vEV1ZWBmIEzIk-Sv7WxoAAa1nJHO9317RltQgq78FPepkLM1Um-ecRFi7d0tUgsYOLtkLv2twLQK8PprwtaP3CUrlzbVUczw-bStPIizncyiesnWiS4AeKLH6tpdc56QU-0YMpiEIZq5wuhXAYVhLMtzuNvAF6TbosuGRe-vcH7sxD2Yx8889gu2nOYf841sseYFgo7t3vAQcdHckojW0zLX-6ADJGcKa_8KD0KO9c=w652-h168-no" border="0" alt=" photo imgonline-com-ua-twotoone-XEN5fUgMoaSc_zpsliygmo1g.jpg"/></a>
</p>
<p align="center">
Fig 1 :: GNSS Data Extraction   
</p>
<br>
